#summary Next steps and open issues

{{{
---

java.lang.AssertionError: oracle.jdbc.pool.OracleImplicitConnectionCacheThread.run()V: register is null for pc '5' and index '5' for operation: STORE 5
	at org.decojer.cavaj.transformers.TrDataFlowAnalysis.markAlive(TrDataFlowAnalysis.java:883)

###

com.google.common.cache.Striped64.retryUpdate(JLcom/google/common/cache/Striped64$HashCode;Z)V (ops: 242, regs: 20)

java.lang.AssertionError: com.google.common.cache.Striped64.retryUpdate(JLcom/google/common/cache/Striped64$HashCode;Z)V: register is null for pc '4' and index '6' for operation: STORE 6

###
	at org.decojer.cavaj.transformers.TrDataFlowAnalysis.markAlive(TrDataFlowAnalysis.java:883)


com.ibm.icu_50.1.1.v201304230130.jar
	com.ibm.icu.text.UnicodeSet.containsAll(Lcom/ibm/icu/text/UnicodeSet;)Z (ops: 101, regs: 13)

}}}

= TODOs =

  * merge-replace register
    * can recursively create new merges, back-branch algorithm
  * variable analysis
    * special recognition of thhis and params for invalid debug vars
  * JSR-merge stuff
  * assign-to with "maybe"
  * inner classes synthetic initializer for eclosing.this, comment in PUT indicates, data flowe analysis must be solved first:
    * we want to rewrite this$0 here, but for this constructor methods have to be handled first to mark such fields for consumption?
    * fieldInit is false for synthetic this$0 initializer in constructor, also not sufficient check for conditionals, alternative via data flow analysis?!
  * JDK 8
    * Eclipse AST for JDK 8: http://www.oracle.com/technetwork/articles/java/lambda-1984522.html
      * JDK 8 Update from: http://download.eclipse.org/eclipse/updates/4.3-P-builds/
        * http://wiki.eclipse.org/JDT_Core/Java8
        * http://wiki.eclipse.org/JDT/Eclipse_Java_8_Support_%28BETA%29
      * *done*: Lombok doesn't work yet ootB in Test Eclipse for JDK 8, fix via added method in Eclipse:
        * https://bugs.eclipse.org/bugs/show_bug.cgi?id=424718
        * http://code.google.com/p/projectlombok/issues/detail?id=597 
      * ASTView not working for new stuff
    * JLS8 API
      * changes for Type Annotations:
        * AnnotatableType & NameQualifiedTypeName
        * ArrayTypes are not recursive anymore, have dimension attribute and elementType instead of componentType
        * method: thrownExceptionTypes instead of thrownExceptions (names)
    * Method References, Default & Static Interface Methods, Lambdas, Repeatable Annotations OK
    * Type Annotations OK, but:
      * Receiver must get fully parameterized reference
      * check more examples: http://www.mscharhag.com/2014/02/java-8-type-annotations.html
      * Eclipse Bugs: https://bugs.eclipse.org/bugs/show_bug.cgi?id=426616
      * JDK Bug: Issue here: https://bugs.openjdk.java.net/issues/?jql=&startIndex=50
      * Eclipse and JDK Bug: http://mail.openjdk.java.net/pipermail/type-annotations-dev/2014-February/001590.html
      * Examples:
        * http://www.tutego.de/blog/javainsel/2012/02/erster-draft-fr-annotations-on-java-types-jsr-308/
      * http://docs.oracle.com/javase/tutorial/java/annotations/repeating.html
    * Inner classes buggy in Eclipse: https://bugs.eclipse.org/bugs/show_bug.cgi?id=426854 
  * other IDEs
    * IntelliJ Plugin
      * http://bjorn.tipling.com/how-to-make-an-intellij-idea-plugin-in-30-minutes
    * Netbeans Plugin

= NOTICES =
Eclipse Editor
  * open JAR: Tree View
  * open JAR: Bytecode View
  * open File@JAR: Switchable to Tree View
  * Save Source

Dalvik
  * initial temporary 0 and 1 are typeless constants (no bool backpropagation)...currently i havn't a good solution for this in the generic code


Web

05.01.12

Blob Stats:

Double Hashes: ffaf5932fcd667088159617ce2072d38, 371ce66ec6edf334cd03a5c36f9f1958, ce83ef281361c29d7826c782cb475ee6, ffaf5932fcd667088159617ce2072d38, eda20137ad51c89953c56027fa1381bd, 5f079ab1450158d894d3dc332aa846f6, 54bbc08b6d3ce2f0ef4243f33c60940f

Number: 126619

Size: 38335640414

{{{
/_ah/queue/decoJer?uploadKey=a74%40_)7FCDy%4018%7DI(AqN%3EW%40A&channelKey=ggpy0c3MqGZ3QkpLo6pcHQ
=>

SELECT * FROM UPLOAD where __key__= KEY('UPLOAD','a74@_)7FCDy@18}I(AqN>W@A')
}}}

Download big Blob file:
{{{
http://www.decojer.org/download/test.tst?u=AMIfv973hPWhetoX_Et1Gn8__ATu5hRHkKaWRnKDrXZfkeR1QSe13v84Sp05AOTtMsS1xeNtquTqv24jl21VJ_l1C7hOKvkT0ILOHS1SXdx3D1nf8L69rSPa1e64euvPAQbgzw4MtGOV9ehmTnrFOW1pe1aNpB8kxQ
}}}


TODOs

md.setParamName besser als START_LOCAL mit pc 0?

check:
 // Compiled from TimelinePropertyBuilder.java (version 1.6 : 50.0, super bit)
// Signature: Lorg/pushingpixels/trident/TimelinePropertyBuilder<TT;>.AbstractFieldInfo<Ljava/lang/Object;>;
private class org.pushingpixels.trident.TimelinePropertyBuilder$GenericFieldInfo extends org.pushingpixels.trident.TimelinePropertyBuilder$AbstractFieldInfo {


Aug 19, 2012 10:52:00 PM org.decojer.cavaj.transformers.TrCfg2JavaExpressionStmts transform
WARNING: Stack underflow in 'org.eclipse.jdt.internal.formatter.comment.HTMLEntity2JavaReader.entity2Text(Ljava/lang/String;)Ljava/lang/String; (ops: 50, regs: 3)':
BB 2 (l 79, pc 30)
Ops: [RETURN]
Aug 19, 2012 10:52:00 PM org.decojer.cavaj.transformers.TrCfg2JavaExpressionStmts rewriteHandler
WARNING: First operation in handler isn't STORE: BB 1 (l 80, pc 31)
Ops: [POP, GOTO 42]
Aug 19, 2012 10:52:00 PM org.decojer.cavaj.transformers.TrCfg2JavaExpressionStmts transform
WARNING: Stack underflow in 'org.eclipse.jdt.internal.formatter.comment.HTMLEntity2JavaReader.entity2Text(Ljava/lang/String;)Ljava/lang/String; (ops: 50, regs: 3)':
BB 1 (l 80, pc 31)
Ops: [POP, GOTO 42]


Bug with split for same-BB-backlinks:

com.itextpdf.text.pdf.PRTokeniser.nextToken()Z (ops: 466, regs: 6)

BB 84 (l 489, pc 440)
Stmts: [outBuf.append((char)ch);
, ch=this.file.read();
, if (!com.itextpdf.text.pdf.PRTokeniser.delims[ch + "1"]) {
}
]

	* JSR adress -> stack-adress/STORE/RET register-address - better STORE handling for handler
	* exception-ends sometimes earlier (RETURN, PUSH/RETURN)...stack underflow...pull incoming nodes?
	* switch case reordering doesn't work anymore...should mark list unmodifiable? or better rely on E.isSwitch...
	* must more agressively inline or i cannot recognize while() loops with expressions like (--i > 2)
	* 
		* load, iinc => i++
		* iinc, load => --i
		* load...dup / store => (i += 10)

	* Maven Model 3.0.4 API direkt nutzen oder Maven Aether, welches auch Dependencies und Parents etc. auflÃ¶st
	* must store register type independantly from register read types, later merge could lower type in hierarchy, merge & store goes top
	* read types: store most specific, read goes bottom, forget nothing

Facts

	* exceptions have changed a lot over versions, especially finally:

		* (GOTO -> JSR)...1.3 (first JSR then GOTO) -> 1.4 (GOTOs not in any-catch - splitted) -> 1.5 (no JSR, inlined finally-code copies)...
		* since 1.5 any-catch (JDK, not Eclipse-compiler) has a strange self-catch, last remark:
http://stackoverflow.com/questions/6386917/strange-exception-table-entry-produced-by-suns-javac
		* Eclipse compiler has yet another form
		* JSR-elimination-cost: http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.104.7844 
		* Exceptions-Ends sometimes earlier if operation cannot generate exception. e.g. RETURN or PUSH -> RETURN

	* jdk1.6.6 bytecode: all exception-handlers special ops like STORE, JSR, GOTO have the try-line as line number
	* 1.6.0_32 and 1.7.0_04 changed something at inner classes bytecode
	* Glossar:

		* Catch -> Handler
		* Switch -> Case
		* Cond -> Branch


Web

	* Upload JAR: Create / check Maven dependencies
	* Upload POM: Check / Show Dependencies
	* Abonnement: POM-Update-Notifications

Blob: Save Version Diffs for space saving if > 30% down

1 GB => 10 cent / month
100 GB are 10 Euro / month

Obfuscator

	* http://www.dzone.com/links/r/java_obfuscate_proguard_maven_configuration_skele.html 